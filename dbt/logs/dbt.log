[0m23:37:21.205619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014184E44380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014187B9F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014187473140>]}


============================== 23:37:21.215219 | 6ab98ab0-be49-4714-8296-8065d05324ba ==============================
[0m23:37:21.215219 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:37:21.216226 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt\\logs'}
[0m23:37:21.791353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001418923FB00>]}
[0m23:37:21.870479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001418923C380>]}
[0m23:37:21.875483 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:37:22.260226 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:37:22.261226 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:37:22.261226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189326BD0>]}
[0m23:37:23.807614 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'stg_opensky_flights' in package 'open_data_air_traffic'
(models\staging\_staging.yml). Arguments to generic tests should be nested under
the `arguments` property.
[0m23:37:23.809516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189BA7BF0>]}
[0m23:37:23.921541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189DBBE90>]}
[0m23:37:24.019953 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m23:37:24.023477 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m23:37:24.105084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189E176B0>]}
[0m23:37:24.106085 [info ] [MainThread]: Found 7 models, 1 seed, 5 data tests, 472 macros
[0m23:37:24.107086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189DAEF00>]}
[0m23:37:24.110492 [info ] [MainThread]: 
[0m23:37:24.110492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:24.111494 [info ] [MainThread]: 
[0m23:37:24.112494 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:37:24.117495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m23:37:24.230913 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m23:37:24.230913 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m23:37:24.231943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:24.265153 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m23:37:24.267159 [debug] [ThreadPool]: On list_analytics: Close
[0m23:37:24.268157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main)
[0m23:37:24.268157 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main"
"
[0m23:37:24.275249 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m23:37:24.276249 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m23:37:24.276249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:24.277248 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:24.279757 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m23:37:24.279757 [debug] [ThreadPool]: On create_analytics_main: BEGIN
[0m23:37:24.280756 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:24.280756 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m23:37:24.281756 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
    
        create schema if not exists "analytics"."main"
    
[0m23:37:24.282758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:24.283758 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m23:37:24.284758 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m23:37:24.284758 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m23:37:24.285757 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:24.285757 [debug] [ThreadPool]: On create_analytics_main: Close
[0m23:37:24.287757 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_main'
[0m23:37:24.293966 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m23:37:24.294968 [debug] [ThreadPool]: On list_analytics_main: BEGIN
[0m23:37:24.294968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:24.295966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:37:24.295966 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m23:37:24.296969 [debug] [ThreadPool]: On list_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics_main"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics'
  
[0m23:37:24.315720 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m23:37:24.316686 [debug] [ThreadPool]: On list_analytics_main: ROLLBACK
[0m23:37:24.319191 [debug] [ThreadPool]: Failed to rollback 'list_analytics_main'
[0m23:37:24.319191 [debug] [ThreadPool]: On list_analytics_main: Close
[0m23:37:24.320197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189BBFB00>]}
[0m23:37:24.320197 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:24.321734 [debug] [MainThread]: On master: BEGIN
[0m23:37:24.321734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:24.322744 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:37:24.322744 [debug] [MainThread]: On master: COMMIT
[0m23:37:24.323741 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:24.323741 [debug] [MainThread]: On master: COMMIT
[0m23:37:24.324746 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:24.325754 [debug] [MainThread]: On master: Close
[0m23:37:24.337353 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.stg_airports
[0m23:37:24.337353 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.stg_opensky_flights
[0m23:37:24.337353 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.stg_weather_hourly
[0m23:37:24.338859 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_airports .................................. [RUN]
[0m23:37:24.339864 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_opensky_flights ........................... [RUN]
[0m23:37:24.340865 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_weather_hourly ............................ [RUN]
[0m23:37:24.340865 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_airports'
[0m23:37:24.341868 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_opensky_flights'
[0m23:37:24.342865 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_weather_hourly'
[0m23:37:24.342865 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.stg_airports
[0m23:37:24.343868 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.stg_opensky_flights
[0m23:37:24.343868 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.stg_weather_hourly
[0m23:37:24.352380 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_airports"
[0m23:37:24.356406 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_opensky_flights"
[0m23:37:24.358943 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_weather_hourly"
[0m23:37:24.361954 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.stg_opensky_flights
[0m23:37:24.362950 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.stg_airports
[0m23:37:24.362950 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.stg_weather_hourly
[0m23:37:24.396512 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_opensky_flights"
[0m23:37:24.401087 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_airports"
[0m23:37:24.405086 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_weather_hourly"
[0m23:37:24.407475 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m23:37:24.407475 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: BEGIN
[0m23:37:24.409011 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:37:24.409011 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m23:37:24.410050 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m23:37:24.411016 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:37:24.411016 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: BEGIN
[0m23:37:24.412045 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: BEGIN
[0m23:37:24.413016 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m23:37:24.413016 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:37:24.414017 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:24.414017 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m23:37:24.416019 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:37:24.416019 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:24.417018 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m23:37:24.418048 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m23:37:24.419016 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m23:37:24.419016 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('data/reference/airports_eu.csv')
  );

[0m23:37:24.423647 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m23:37:24.424646 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('data/reference/airports_eu.csv')
  );

[0m23:37:24.425645 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m23:37:24.425645 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:24.426647 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:24.427646 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:24.427646 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: ROLLBACK
[0m23:37:24.429152 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: ROLLBACK
[0m23:37:24.429152 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: ROLLBACK
[0m23:37:24.444184 [debug] [Thread-3 (]: Failed to rollback 'model.open_data_air_traffic.stg_weather_hourly'
[0m23:37:24.445185 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: Close
[0m23:37:24.447183 [debug] [Thread-2 (]: Failed to rollback 'model.open_data_air_traffic.stg_opensky_flights'
[0m23:37:24.448688 [debug] [Thread-1 (]: Failed to rollback 'model.open_data_air_traffic.stg_airports'
[0m23:37:24.450695 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: Close
[0m23:37:24.450695 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: Close
[0m23:37:24.453695 [debug] [Thread-3 (]: Runtime Error in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)
  IO Error: No files found that match the pattern "data/raw/weather/*/*.json"
  
  LINE 7:     from read_json_auto(
                   ^
[0m23:37:24.457696 [debug] [Thread-2 (]: Runtime Error in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)
  IO Error: No files found that match the pattern "data/raw/opensky/*/*.jsonl"
  
  LINE 7:     from read_json_auto(
                   ^
[0m23:37:24.460206 [debug] [Thread-1 (]: Runtime Error in model stg_airports (models\staging\stg_airports.sql)
  IO Error: No files found that match the pattern "data/reference/airports_eu.csv"
  
  LINE 11: from read_csv_auto('data/reference/airports_eu.csv')
                ^
[0m23:37:24.461204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001418A16E090>]}
[0m23:37:24.461204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014189C75C40>]}
[0m23:37:24.462206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab98ab0-be49-4714-8296-8065d05324ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001418A23BE30>]}
[0m23:37:24.462206 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_weather_hourly ................... [[31mERROR[0m in 0.11s]
[0m23:37:24.463206 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_opensky_flights .................. [[31mERROR[0m in 0.12s]
[0m23:37:24.464207 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_airports ......................... [[31mERROR[0m in 0.12s]
[0m23:37:24.465207 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.stg_weather_hourly
[0m23:37:24.466205 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.stg_opensky_flights
[0m23:37:24.467206 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.stg_airports
[0m23:37:24.467206 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.stg_weather_hourly' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)
  IO Error: No files found that match the pattern "data/raw/weather/*/*.json"
  
  LINE 7:     from read_json_auto(
                   ^.
[0m23:37:24.468709 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.stg_opensky_flights' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)
  IO Error: No files found that match the pattern "data/raw/opensky/*/*.jsonl"
  
  LINE 7:     from read_json_auto(
                   ^.
[0m23:37:24.469715 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.stg_airports' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_airports (models\staging\stg_airports.sql)
  IO Error: No files found that match the pattern "data/reference/airports_eu.csv"
  
  LINE 11: from read_csv_auto('data/reference/airports_eu.csv')
                ^.
[0m23:37:24.470717 [debug] [Thread-4 (]: Began running node model.open_data_air_traffic.int_flights_with_weather
[0m23:37:24.471716 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.int_flights_with_weather ............................. [[33mSKIP[0m]
[0m23:37:24.471716 [debug] [Thread-4 (]: Finished running node model.open_data_air_traffic.int_flights_with_weather
[0m23:37:24.472715 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.mart_flight_features
[0m23:37:24.473714 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.qa_daily_completeness
[0m23:37:24.473714 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.qa_join_coverage
[0m23:37:24.474716 [info ] [Thread-2 (]: 5 of 7 SKIP relation main.mart_flight_features ................................. [[33mSKIP[0m]
[0m23:37:24.475718 [info ] [Thread-1 (]: 6 of 7 SKIP relation main.qa_daily_completeness ................................ [[33mSKIP[0m]
[0m23:37:24.475718 [info ] [Thread-3 (]: 7 of 7 SKIP relation main.qa_join_coverage ..................................... [[33mSKIP[0m]
[0m23:37:24.476715 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.mart_flight_features
[0m23:37:24.477718 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.qa_daily_completeness
[0m23:37:24.477718 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.qa_join_coverage
[0m23:37:24.479948 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:24.479948 [debug] [MainThread]: On master: BEGIN
[0m23:37:24.480948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:24.481948 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:37:24.481948 [debug] [MainThread]: On master: COMMIT
[0m23:37:24.482948 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:24.482948 [debug] [MainThread]: On master: COMMIT
[0m23:37:24.483947 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:24.483947 [debug] [MainThread]: On master: Close
[0m23:37:24.484950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:24.484950 [debug] [MainThread]: Connection 'create_analytics_main' was properly closed.
[0m23:37:24.485948 [debug] [MainThread]: Connection 'list_analytics_main' was properly closed.
[0m23:37:24.485948 [debug] [MainThread]: Connection 'model.open_data_air_traffic.stg_airports' was properly closed.
[0m23:37:24.486949 [debug] [MainThread]: Connection 'model.open_data_air_traffic.stg_opensky_flights' was properly closed.
[0m23:37:24.486949 [debug] [MainThread]: Connection 'model.open_data_air_traffic.stg_weather_hourly' was properly closed.
[0m23:37:24.487946 [info ] [MainThread]: 
[0m23:37:24.487946 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m23:37:24.489456 [debug] [MainThread]: Command end result
[0m23:37:24.516520 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m23:37:24.520008 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m23:37:24.526520 [debug] [MainThread]: Wrote artifact RunExecutionResult to H:\Bureau\Pro\Ecole\Open Data\dbt\target\run_results.json
[0m23:37:24.527521 [info ] [MainThread]: 
[0m23:37:24.527521 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:37:24.529027 [info ] [MainThread]: 
[0m23:37:24.529027 [error] [MainThread]: [31mFailure in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)[0m
[0m23:37:24.530034 [error] [MainThread]:   Runtime Error in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)
  IO Error: No files found that match the pattern "data/raw/weather/*/*.json"
  
  LINE 7:     from read_json_auto(
                   ^
[0m23:37:24.530977 [info ] [MainThread]: 
[0m23:37:24.531984 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\staging\stg_weather_hourly.sql
[0m23:37:24.531984 [info ] [MainThread]: 
[0m23:37:24.532983 [error] [MainThread]: [31mFailure in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)[0m
[0m23:37:24.533984 [error] [MainThread]:   Runtime Error in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)
  IO Error: No files found that match the pattern "data/raw/opensky/*/*.jsonl"
  
  LINE 7:     from read_json_auto(
                   ^
[0m23:37:24.533984 [info ] [MainThread]: 
[0m23:37:24.535008 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\staging\stg_opensky_flights.sql
[0m23:37:24.535982 [info ] [MainThread]: 
[0m23:37:24.535982 [error] [MainThread]: [31mFailure in model stg_airports (models\staging\stg_airports.sql)[0m
[0m23:37:24.536982 [error] [MainThread]:   Runtime Error in model stg_airports (models\staging\stg_airports.sql)
  IO Error: No files found that match the pattern "data/reference/airports_eu.csv"
  
  LINE 11: from read_csv_auto('data/reference/airports_eu.csv')
                ^
[0m23:37:24.537982 [info ] [MainThread]: 
[0m23:37:24.537982 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\staging\stg_airports.sql
[0m23:37:24.538983 [info ] [MainThread]: 
[0m23:37:24.540068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=7
[0m23:37:24.540068 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:37:24.542075 [debug] [MainThread]: Command `dbt run` failed at 23:37:24.542075 after 3.49 seconds
[0m23:37:24.542075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014184E44380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014186FCB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014184548BC0>]}
[0m23:37:24.543074 [debug] [MainThread]: Flushing usage events
[0m23:37:24.916431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:57.065570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D494A180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D494B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D494BB90>]}


============================== 00:15:57.071082 | c1f1904b-61ed-494b-95d8-bcdf6afd0e99 ==============================
[0m00:15:57.071082 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:15:57.072311 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt\\logs'}
[0m00:15:57.361047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D6ABD070>]}
[0m00:15:57.434634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D6B221E0>]}
[0m00:15:57.438635 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:15:57.812702 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:15:57.978145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:15:57.978145 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:15:57.979147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:15:58.031439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D6B23590>]}
[0m00:15:58.122964 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:15:58.124933 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:15:58.147078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D6FC9070>]}
[0m00:15:58.148048 [info ] [MainThread]: Found 7 models, 1 seed, 5 data tests, 472 macros
[0m00:15:58.148925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D6C51310>]}
[0m00:15:58.150984 [info ] [MainThread]: 
[0m00:15:58.151979 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:15:58.153013 [info ] [MainThread]: 
[0m00:15:58.153013 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:15:58.158974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m00:15:58.297820 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m00:15:58.298821 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m00:15:58.298821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:58.318932 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:15:58.321383 [debug] [ThreadPool]: On list_analytics: Close
[0m00:15:58.321383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main)
[0m00:15:58.322382 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main"
"
[0m00:15:58.329886 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:15:58.329886 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m00:15:58.330890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:58.331890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:15:58.333895 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:15:58.333895 [debug] [ThreadPool]: On create_analytics_main: BEGIN
[0m00:15:58.334894 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:15:58.334894 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:15:58.335894 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
    
        create schema if not exists "analytics"."main"
    
[0m00:15:58.336892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:15:58.337891 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:15:58.337891 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:15:58.338890 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:15:58.338890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:15:58.339892 [debug] [ThreadPool]: On create_analytics_main: Close
[0m00:15:58.341237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_main'
[0m00:15:58.347238 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:15:58.348236 [debug] [ThreadPool]: On list_analytics_main: BEGIN
[0m00:15:58.348236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:58.349740 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:15:58.349740 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:15:58.350747 [debug] [ThreadPool]: On list_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics_main"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics'
  
[0m00:15:58.366819 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:15:58.367821 [debug] [ThreadPool]: On list_analytics_main: ROLLBACK
[0m00:15:58.369822 [debug] [ThreadPool]: Failed to rollback 'list_analytics_main'
[0m00:15:58.370333 [debug] [ThreadPool]: On list_analytics_main: Close
[0m00:15:58.371337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D66ECEF0>]}
[0m00:15:58.372336 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:58.372336 [debug] [MainThread]: On master: BEGIN
[0m00:15:58.372336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:58.373335 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:15:58.374338 [debug] [MainThread]: On master: COMMIT
[0m00:15:58.374338 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:58.375335 [debug] [MainThread]: On master: COMMIT
[0m00:15:58.375335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:15:58.376336 [debug] [MainThread]: On master: Close
[0m00:15:58.381330 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.stg_airports
[0m00:15:58.381330 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.stg_opensky_flights
[0m00:15:58.382358 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.stg_weather_hourly
[0m00:15:58.382358 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_airports .................................. [RUN]
[0m00:15:58.383358 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_opensky_flights ........................... [RUN]
[0m00:15:58.384335 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_weather_hourly ............................ [RUN]
[0m00:15:58.385327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_airports'
[0m00:15:58.385327 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_opensky_flights'
[0m00:15:58.386358 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_weather_hourly'
[0m00:15:58.387360 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.stg_airports
[0m00:15:58.387360 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.stg_opensky_flights
[0m00:15:58.388330 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.stg_weather_hourly
[0m00:15:58.395876 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_airports"
[0m00:15:58.398947 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:15:58.401522 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:15:58.403490 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.stg_airports
[0m00:15:58.435094 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.stg_opensky_flights
[0m00:15:58.440091 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_airports"
[0m00:15:58.440091 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.stg_weather_hourly
[0m00:15:58.443430 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:15:58.447460 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:15:58.448464 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:15:58.448464 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:15:58.449969 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: BEGIN
[0m00:15:58.450977 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: BEGIN
[0m00:15:58.450977 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:15:58.452014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:15:58.452833 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:15:58.452833 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: BEGIN
[0m00:15:58.454842 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:15:58.454842 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:15:58.455840 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:15:58.455840 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:15:58.456840 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:15:58.457840 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('data/reference/airports_eu.csv')
  );

[0m00:15:58.458838 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:15:58.459218 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m00:15:58.459881 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:15:58.460887 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('data/reference/airports_eu.csv')
  );

[0m00:15:58.461469 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m00:15:58.462474 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m00:15:58.462474 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:15:58.463504 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m00:15:58.464475 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        'data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m00:15:58.465475 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: ROLLBACK
[0m00:15:58.465475 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: ROLLBACK
[0m00:15:58.466475 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m00:15:58.470008 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: ROLLBACK
[0m00:15:58.478525 [debug] [Thread-3 (]: Failed to rollback 'model.open_data_air_traffic.stg_weather_hourly'
[0m00:15:58.480029 [debug] [Thread-2 (]: Failed to rollback 'model.open_data_air_traffic.stg_opensky_flights'
[0m00:15:58.482036 [debug] [Thread-1 (]: Failed to rollback 'model.open_data_air_traffic.stg_airports'
[0m00:15:58.483035 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: Close
[0m00:15:58.483035 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: Close
[0m00:15:58.484036 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: Close
[0m00:15:58.489034 [debug] [Thread-3 (]: Runtime Error in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)
  IO Error: No files found that match the pattern "data/raw/weather/*/*.json"
  
  LINE 7:     from read_json_auto(
                   ^
[0m00:15:58.490540 [debug] [Thread-2 (]: Runtime Error in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)
  IO Error: No files found that match the pattern "data/raw/opensky/*/*.jsonl"
  
  LINE 7:     from read_json_auto(
                   ^
[0m00:15:58.493545 [debug] [Thread-1 (]: Runtime Error in model stg_airports (models\staging\stg_airports.sql)
  IO Error: No files found that match the pattern "data/reference/airports_eu.csv"
  
  LINE 11: from read_csv_auto('data/reference/airports_eu.csv')
                ^
[0m00:15:58.494547 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D499DB20>]}
[0m00:15:58.494547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D7033B30>]}
[0m00:15:58.494547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f1904b-61ed-494b-95d8-bcdf6afd0e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D73395B0>]}
[0m00:15:58.495546 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model main.stg_weather_hourly ................... [[31mERROR[0m in 0.10s]
[0m00:15:58.496545 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model main.stg_opensky_flights .................. [[31mERROR[0m in 0.11s]
[0m00:15:58.497545 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.stg_airports ......................... [[31mERROR[0m in 0.11s]
[0m00:15:58.498547 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.stg_weather_hourly
[0m00:15:58.498547 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.stg_opensky_flights
[0m00:15:58.500053 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.stg_airports
[0m00:15:58.501059 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.stg_weather_hourly' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)
  IO Error: No files found that match the pattern "data/raw/weather/*/*.json"
  
  LINE 7:     from read_json_auto(
                   ^.
[0m00:15:58.502061 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.stg_opensky_flights' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)
  IO Error: No files found that match the pattern "data/raw/opensky/*/*.jsonl"
  
  LINE 7:     from read_json_auto(
                   ^.
[0m00:15:58.503059 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.stg_airports' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_airports (models\staging\stg_airports.sql)
  IO Error: No files found that match the pattern "data/reference/airports_eu.csv"
  
  LINE 11: from read_csv_auto('data/reference/airports_eu.csv')
                ^.
[0m00:15:58.504061 [debug] [Thread-4 (]: Began running node model.open_data_air_traffic.int_flights_with_weather
[0m00:15:58.504834 [info ] [Thread-4 (]: 4 of 7 SKIP relation main.int_flights_with_weather ............................. [[33mSKIP[0m]
[0m00:15:58.505432 [debug] [Thread-4 (]: Finished running node model.open_data_air_traffic.int_flights_with_weather
[0m00:15:58.506438 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.mart_flight_features
[0m00:15:58.507437 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.qa_daily_completeness
[0m00:15:58.507437 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.qa_join_coverage
[0m00:15:58.507437 [info ] [Thread-2 (]: 5 of 7 SKIP relation main.mart_flight_features ................................. [[33mSKIP[0m]
[0m00:15:58.508438 [info ] [Thread-1 (]: 6 of 7 SKIP relation main.qa_daily_completeness ................................ [[33mSKIP[0m]
[0m00:15:58.509943 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.mart_flight_features
[0m00:15:58.508438 [info ] [Thread-3 (]: 7 of 7 SKIP relation main.qa_join_coverage ..................................... [[33mSKIP[0m]
[0m00:15:58.509943 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.qa_daily_completeness
[0m00:15:58.510950 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.qa_join_coverage
[0m00:15:58.512950 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:58.513952 [debug] [MainThread]: On master: BEGIN
[0m00:15:58.513952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:15:58.515059 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:15:58.516061 [debug] [MainThread]: On master: COMMIT
[0m00:15:58.516061 [debug] [MainThread]: Using duckdb connection "master"
[0m00:15:58.516061 [debug] [MainThread]: On master: COMMIT
[0m00:15:58.517059 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:15:58.518060 [debug] [MainThread]: On master: Close
[0m00:15:58.518060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:58.519060 [debug] [MainThread]: Connection 'create_analytics_main' was properly closed.
[0m00:15:58.519060 [debug] [MainThread]: Connection 'list_analytics_main' was properly closed.
[0m00:15:58.520060 [debug] [MainThread]: Connection 'model.open_data_air_traffic.stg_airports' was properly closed.
[0m00:15:58.520060 [debug] [MainThread]: Connection 'model.open_data_air_traffic.stg_opensky_flights' was properly closed.
[0m00:15:58.520060 [debug] [MainThread]: Connection 'model.open_data_air_traffic.stg_weather_hourly' was properly closed.
[0m00:15:58.521212 [info ] [MainThread]: 
[0m00:15:58.521212 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m00:15:58.523212 [debug] [MainThread]: Command end result
[0m00:15:58.551778 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:15:58.554776 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:15:58.561912 [debug] [MainThread]: Wrote artifact RunExecutionResult to H:\Bureau\Pro\Ecole\Open Data\dbt\target\run_results.json
[0m00:15:58.562913 [info ] [MainThread]: 
[0m00:15:58.563907 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:15:58.563907 [info ] [MainThread]: 
[0m00:15:58.564906 [error] [MainThread]: [31mFailure in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)[0m
[0m00:15:58.565906 [error] [MainThread]:   Runtime Error in model stg_weather_hourly (models\staging\stg_weather_hourly.sql)
  IO Error: No files found that match the pattern "data/raw/weather/*/*.json"
  
  LINE 7:     from read_json_auto(
                   ^
[0m00:15:58.565906 [info ] [MainThread]: 
[0m00:15:58.566909 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\staging\stg_weather_hourly.sql
[0m00:15:58.567906 [info ] [MainThread]: 
[0m00:15:58.567906 [error] [MainThread]: [31mFailure in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)[0m
[0m00:15:58.568906 [error] [MainThread]:   Runtime Error in model stg_opensky_flights (models\staging\stg_opensky_flights.sql)
  IO Error: No files found that match the pattern "data/raw/opensky/*/*.jsonl"
  
  LINE 7:     from read_json_auto(
                   ^
[0m00:15:58.569908 [info ] [MainThread]: 
[0m00:15:58.569908 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\staging\stg_opensky_flights.sql
[0m00:15:58.570979 [info ] [MainThread]: 
[0m00:15:58.571978 [error] [MainThread]: [31mFailure in model stg_airports (models\staging\stg_airports.sql)[0m
[0m00:15:58.572977 [error] [MainThread]:   Runtime Error in model stg_airports (models\staging\stg_airports.sql)
  IO Error: No files found that match the pattern "data/reference/airports_eu.csv"
  
  LINE 11: from read_csv_auto('data/reference/airports_eu.csv')
                ^
[0m00:15:58.572977 [info ] [MainThread]: 
[0m00:15:58.573977 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\staging\stg_airports.sql
[0m00:15:58.573977 [info ] [MainThread]: 
[0m00:15:58.574978 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 NO-OP=0 TOTAL=7
[0m00:15:58.577491 [debug] [MainThread]: Command `dbt run` failed at 00:15:58.577491 after 1.65 seconds
[0m00:15:58.577491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D66AFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D494BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D494B7D0>]}
[0m00:15:58.578491 [debug] [MainThread]: Flushing usage events
[0m00:15:58.945194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:51.833802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F42840E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F398CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F6FDEF30>]}


============================== 00:18:51.839810 | 2e27ca09-97b0-44af-8135-7dd8822c3f81 ==============================
[0m00:18:51.839810 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:18:51.839810 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt\\logs'}
[0m00:18:52.124421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8A4E720>]}
[0m00:18:52.197908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8623F50>]}
[0m00:18:52.200448 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:18:52.581136 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:18:52.737104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:18:52.737104 [debug] [MainThread]: Partial parsing: updated file: open_data_air_traffic://models\staging\stg_weather_hourly.sql
[0m00:18:52.738105 [debug] [MainThread]: Partial parsing: updated file: open_data_air_traffic://models\staging\stg_opensky_flights.sql
[0m00:18:52.738105 [debug] [MainThread]: Partial parsing: updated file: open_data_air_traffic://models\staging\stg_airports.sql
[0m00:18:53.152945 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'stg_opensky_flights' in package 'open_data_air_traffic'
(models\staging\_staging.yml). Arguments to generic tests should be nested under
the `arguments` property.
[0m00:18:53.153945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F90EA870>]}
[0m00:18:53.241435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F910DA90>]}
[0m00:18:53.330533 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:18:53.333534 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:18:53.406117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F900F590>]}
[0m00:18:53.407117 [info ] [MainThread]: Found 7 models, 1 seed, 5 data tests, 472 macros
[0m00:18:53.407117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F91C6480>]}
[0m00:18:53.410114 [info ] [MainThread]: 
[0m00:18:53.410621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:18:53.411634 [info ] [MainThread]: 
[0m00:18:53.411634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:18:53.418625 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m00:18:53.516533 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m00:18:53.517530 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m00:18:53.517530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:53.533546 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:18:53.534546 [debug] [ThreadPool]: On list_analytics: Close
[0m00:18:53.535544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main)
[0m00:18:53.536545 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main"
"
[0m00:18:53.544009 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:18:53.545009 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m00:18:53.545009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:53.547010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:53.548044 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:18:53.549008 [debug] [ThreadPool]: On create_analytics_main: BEGIN
[0m00:18:53.550009 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:53.550009 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:18:53.550009 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
    
        create schema if not exists "analytics"."main"
    
[0m00:18:53.551466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:53.552475 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:18:53.553475 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:18:53.553475 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:18:53.554475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:18:53.554475 [debug] [ThreadPool]: On create_analytics_main: Close
[0m00:18:53.556471 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_main'
[0m00:18:53.564546 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:18:53.564546 [debug] [ThreadPool]: On list_analytics_main: BEGIN
[0m00:18:53.565553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:53.566582 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:18:53.566582 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:18:53.567553 [debug] [ThreadPool]: On list_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics_main"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics'
  
[0m00:18:53.582245 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:18:53.584277 [debug] [ThreadPool]: On list_analytics_main: ROLLBACK
[0m00:18:53.586244 [debug] [ThreadPool]: Failed to rollback 'list_analytics_main'
[0m00:18:53.586244 [debug] [ThreadPool]: On list_analytics_main: Close
[0m00:18:53.587245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8FD89B0>]}
[0m00:18:53.588247 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:53.588247 [debug] [MainThread]: On master: BEGIN
[0m00:18:53.589245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:53.589997 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:18:53.590537 [debug] [MainThread]: On master: COMMIT
[0m00:18:53.590537 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:53.591539 [debug] [MainThread]: On master: COMMIT
[0m00:18:53.591539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:53.592579 [debug] [MainThread]: On master: Close
[0m00:18:53.597538 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.stg_airports
[0m00:18:53.597538 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.stg_opensky_flights
[0m00:18:53.598539 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.stg_weather_hourly
[0m00:18:53.598539 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_airports .................................. [RUN]
[0m00:18:53.600044 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_opensky_flights ........................... [RUN]
[0m00:18:53.602051 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_airports'
[0m00:18:53.600044 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_weather_hourly ............................ [RUN]
[0m00:18:53.602399 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_opensky_flights'
[0m00:18:53.603403 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.stg_airports
[0m00:18:53.603403 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_weather_hourly'
[0m00:18:53.604405 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.stg_opensky_flights
[0m00:18:53.612948 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_airports"
[0m00:18:53.612948 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.stg_weather_hourly
[0m00:18:53.616952 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.620459 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.621463 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.stg_airports
[0m00:18:53.657044 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_airports"
[0m00:18:53.658042 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.stg_opensky_flights
[0m00:18:53.658042 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.stg_weather_hourly
[0m00:18:53.662580 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.662580 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:18:53.666092 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.667330 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: BEGIN
[0m00:18:53.668340 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.668340 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:53.669958 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.669958 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: BEGIN
[0m00:18:53.671964 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: BEGIN
[0m00:18:53.671964 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:53.672963 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:18:53.672963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:18:53.673963 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:18:53.674963 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:18:53.674963 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:18:53.675963 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('../data/reference/airports_eu.csv')
  );

[0m00:18:53.676964 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.676964 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.677965 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        '../data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m00:18:53.678997 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        '../data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m00:18:53.700384 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m00:18:53.707494 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.708494 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m00:18:53.708494 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m00:18:53.708494 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */
alter view "analytics"."main"."stg_opensky_flights__dbt_tmp" rename to "stg_opensky_flights"
[0m00:18:53.713049 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:18:53.717049 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.720057 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */
alter view "analytics"."main"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m00:18:53.721062 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */
alter view "analytics"."main"."stg_weather_hourly__dbt_tmp" rename to "stg_weather_hourly"
[0m00:18:53.722062 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m00:18:53.723063 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:18:53.723063 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:18:53.734580 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: COMMIT
[0m00:18:53.736455 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: COMMIT
[0m00:18:53.738485 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: COMMIT
[0m00:18:53.738485 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.739991 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.739991 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:18:53.740997 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: COMMIT
[0m00:18:53.741996 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: COMMIT
[0m00:18:53.741996 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: COMMIT
[0m00:18:53.753523 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m00:18:53.761035 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:18:53.761035 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m00:18:53.762039 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:18:53.762039 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

      drop view if exists "analytics"."main"."stg_opensky_flights__dbt_backup" cascade
    
[0m00:18:53.764545 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:18:53.767833 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:18:53.771372 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

      drop view if exists "analytics"."main"."stg_weather_hourly__dbt_backup" cascade
    
[0m00:18:53.772372 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

      drop view if exists "analytics"."main"."stg_airports__dbt_backup" cascade
    
[0m00:18:53.773371 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m00:18:53.773371 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:18:53.774372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:18:53.776404 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: Close
[0m00:18:53.778402 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: Close
[0m00:18:53.779907 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: Close
[0m00:18:53.782913 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8FCD3A0>]}
[0m00:18:53.782913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA46A6F0>]}
[0m00:18:53.784034 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F9022720>]}
[0m00:18:53.784034 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_opensky_flights ...................... [[32mOK[0m in 0.18s]
[0m00:18:53.785069 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_airports ............................. [[32mOK[0m in 0.18s]
[0m00:18:53.787069 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.stg_opensky_flights
[0m00:18:53.786070 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_weather_hourly ....................... [[32mOK[0m in 0.18s]
[0m00:18:53.788039 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.stg_airports
[0m00:18:53.788915 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.stg_weather_hourly
[0m00:18:53.789918 [debug] [Thread-4 (]: Began running node model.open_data_air_traffic.int_flights_with_weather
[0m00:18:53.790924 [info ] [Thread-4 (]: 4 of 7 START sql view model main.int_flights_with_weather ...................... [RUN]
[0m00:18:53.791926 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.int_flights_with_weather'
[0m00:18:53.792925 [debug] [Thread-4 (]: Began compiling node model.open_data_air_traffic.int_flights_with_weather
[0m00:18:53.795925 [debug] [Thread-4 (]: Writing injected SQL for node "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.796925 [debug] [Thread-4 (]: Began executing node model.open_data_air_traffic.int_flights_with_weather
[0m00:18:53.801438 [debug] [Thread-4 (]: Writing runtime sql for node "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.802435 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.803436 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: BEGIN
[0m00:18:53.803436 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:18:53.804439 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:18:53.805437 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.805437 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */

  
  create view "analytics"."main"."int_flights_with_weather__dbt_tmp" as (
    with flights as (
    select *
    from "analytics"."main"."stg_opensky_flights"
),
weather as (
    select *
    from "analytics"."main"."stg_weather_hourly"
)

select
    f.*,
    case
        when f.flight_type = 'departure' then f.first_seen_hour_utc
        else f.last_seen_hour_utc
    end as event_hour_utc,
    w.temperature_2m,
    w.precipitation,
    w.wind_speed_10m,
    w.cloud_cover
from flights f
left join weather w
    on w.airport_icao = f.airport_icao
   and w.time_utc = case
        when f.flight_type = 'departure' then f.first_seen_hour_utc
        else f.last_seen_hour_utc
    end
  );

[0m00:18:53.811949 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m00:18:53.814949 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.815950 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */
alter view "analytics"."main"."int_flights_with_weather__dbt_tmp" rename to "int_flights_with_weather"
[0m00:18:53.816949 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:18:53.818949 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: COMMIT
[0m00:18:53.819949 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.820456 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: COMMIT
[0m00:18:53.823461 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:18:53.826461 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:18:53.827490 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */

      drop view if exists "analytics"."main"."int_flights_with_weather__dbt_backup" cascade
    
[0m00:18:53.828460 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:18:53.829964 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: Close
[0m00:18:53.831973 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F9390E30>]}
[0m00:18:53.831973 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.int_flights_with_weather ................. [[32mOK[0m in 0.04s]
[0m00:18:53.833122 [debug] [Thread-4 (]: Finished running node model.open_data_air_traffic.int_flights_with_weather
[0m00:18:53.834606 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.mart_flight_features
[0m00:18:53.834606 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.qa_daily_completeness
[0m00:18:53.835642 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.qa_join_coverage
[0m00:18:53.836643 [info ] [Thread-1 (]: 5 of 7 START sql table model main.mart_flight_features ......................... [RUN]
[0m00:18:53.836643 [info ] [Thread-3 (]: 6 of 7 START sql view model main.qa_daily_completeness ......................... [RUN]
[0m00:18:53.837651 [info ] [Thread-2 (]: 7 of 7 START sql view model main.qa_join_coverage .............................. [RUN]
[0m00:18:53.838612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_airports, now model.open_data_air_traffic.mart_flight_features)
[0m00:18:53.838612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_weather_hourly, now model.open_data_air_traffic.qa_daily_completeness)
[0m00:18:53.840151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_opensky_flights, now model.open_data_air_traffic.qa_join_coverage)
[0m00:18:53.841160 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.mart_flight_features
[0m00:18:53.841160 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.qa_daily_completeness
[0m00:18:53.842157 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.qa_join_coverage
[0m00:18:53.846164 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.mart_flight_features"
[0m00:18:53.850163 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.855188 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.856605 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.mart_flight_features
[0m00:18:53.881657 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.mart_flight_features"
[0m00:18:53.882657 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.qa_join_coverage
[0m00:18:53.882657 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.qa_daily_completeness
[0m00:18:53.886657 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.891169 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.891169 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:18:53.892168 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: BEGIN
[0m00:18:53.893169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:53.894170 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.895168 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.895168 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: BEGIN
[0m00:18:53.896168 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:18:53.897168 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: BEGIN
[0m00:18:53.897620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:18:53.898224 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:18:53.898224 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:18:53.899765 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */

  
    
    

    create  table
      "analytics"."main"."mart_flight_features__dbt_tmp"
  
    as (
      with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
),
airports as (
    select *
    from "analytics"."main"."stg_airports"
),
holidays as (
    select
        cast(date as date) as holiday_date,
        upper(country_code) as country_code,
        is_holiday
    from "analytics"."main"."holidays_eu"
)

select
    f.icao24,
    f.callsign,
    f.flight_type,
    f.airport_icao,
    f.est_departure_airport,
    f.est_arrival_airport,
    f.first_seen_ts_utc,
    f.last_seen_ts_utc,
    f.event_hour_utc,
    date_diff('minute', f.first_seen_ts_utc, f.last_seen_ts_utc) as flight_duration_min,
    extract('hour' from f.event_hour_utc) as hour_of_day_utc,
    extract('dow' from f.event_hour_utc) as day_of_week_utc,
    extract('month' from f.event_hour_utc) as month_utc,
    extract('week' from f.event_hour_utc) as week_of_year_utc,
    extract('doy' from f.event_hour_utc) as day_of_year_utc,
    case when extract('dow' from f.event_hour_utc) in (0, 6) then true else false end as is_weekend_utc,
    f.temperature_2m,
    f.precipitation,
    f.wind_speed_10m,
    f.cloud_cover,
    a.country_code as airport_country_code,
    concat(f.est_departure_airport, '-', f.est_arrival_airport) as route_code,
    coalesce(h.is_holiday, false) as is_holiday
from flights f
left join airports a
    on a.icao = f.airport_icao
left join holidays h
    on h.country_code = a.country_code
   and h.holiday_date = cast(f.event_hour_utc as date)
    );
  
  
[0m00:18:53.899765 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:18:53.900772 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:18:53.901803 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.902795 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.902795 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */

  
  create view "analytics"."main"."qa_join_coverage__dbt_tmp" as (
    with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
)

select
    date_trunc('day', event_hour_utc) as day_utc,
    count(*) as flights_total,
    count(*) filter (where temperature_2m is not null) as flights_with_weather,
    round(
        100.0 * count(*) filter (where temperature_2m is not null) / nullif(count(*), 0),
        2
    ) as pct_with_weather
from flights
group by 1
  );

[0m00:18:53.903771 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */

  
  create view "analytics"."main"."qa_daily_completeness__dbt_tmp" as (
    with flights as (
    select
        airport_icao,
        date_trunc('day', event_hour_utc) as day_utc,
        count(*) as flights_count
    from "analytics"."main"."int_flights_with_weather"
    group by 1, 2
),
weather as (
    select
        airport_icao,
        date_trunc('day', time_utc) as day_utc,
        count(*) as weather_hours_count
    from "analytics"."main"."stg_weather_hourly"
    group by 1, 2
)

select
    coalesce(f.airport_icao, w.airport_icao) as airport_icao,
    coalesce(f.day_utc, w.day_utc) as day_utc,
    coalesce(f.flights_count, 0) as flights_count,
    coalesce(w.weather_hours_count, 0) as weather_hours_count,
    case
        when coalesce(w.weather_hours_count, 0) >= 24 then 0
        else 24 - coalesce(w.weather_hours_count, 0)
    end as missing_weather_hours
from flights f
full join weather w
    on f.airport_icao = w.airport_icao
   and f.day_utc = w.day_utc
  );

[0m00:18:53.915857 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */

  
    
    

    create  table
      "analytics"."main"."mart_flight_features__dbt_tmp"
  
    as (
      with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
),
airports as (
    select *
    from "analytics"."main"."stg_airports"
),
holidays as (
    select
        cast(date as date) as holiday_date,
        upper(country_code) as country_code,
        is_holiday
    from "analytics"."main"."holidays_eu"
)

select
    f.icao24,
    f.callsign,
    f.flight_type,
    f.airport_icao,
    f.est_departure_airport,
    f.est_arrival_airport,
    f.first_seen_ts_utc,
    f.last_seen_ts_utc,
    f.event_hour_utc,
    date_diff('minute', f.first_seen_ts_utc, f.last_seen_ts_utc) as flight_duration_min,
    extract('hour' from f.event_hour_utc) as hour_of_day_utc,
    extract('dow' from f.event_hour_utc) as day_of_week_utc,
    extract('month' from f.event_hour_utc) as month_utc,
    extract('week' from f.event_hour_utc) as week_of_year_utc,
    extract('doy' from f.event_hour_utc) as day_of_year_utc,
    case when extract('dow' from f.event_hour_utc) in (0, 6) then true else false end as is_weekend_utc,
    f.temperature_2m,
    f.precipitation,
    f.wind_speed_10m,
    f.cloud_cover,
    a.country_code as airport_country_code,
    concat(f.est_departure_airport, '-', f.est_arrival_airport) as route_code,
    coalesce(h.is_holiday, false) as is_holiday
from flights f
left join airports a
    on a.icao = f.airport_icao
left join holidays h
    on h.country_code = a.country_code
   and h.holiday_date = cast(f.event_hour_utc as date)
    );
  
  
[0m00:18:53.915857 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:18:53.916856 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: ROLLBACK
[0m00:18:53.918855 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m00:18:53.922332 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.923325 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */
alter view "analytics"."main"."qa_join_coverage__dbt_tmp" rename to "qa_join_coverage"
[0m00:18:53.923325 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m00:18:53.924357 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:18:53.928325 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.929830 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: COMMIT
[0m00:18:53.930836 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */
alter view "analytics"."main"."qa_daily_completeness__dbt_tmp" rename to "qa_daily_completeness"
[0m00:18:53.931835 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.932835 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: COMMIT
[0m00:18:53.933835 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:18:53.934836 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: COMMIT
[0m00:18:53.935837 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.936835 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: COMMIT
[0m00:18:53.936835 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m00:18:53.938836 [debug] [Thread-1 (]: Failed to rollback 'model.open_data_air_traffic.mart_flight_features'
[0m00:18:53.942048 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:18:53.942048 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:18:53.943049 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: Close
[0m00:18:53.944049 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */

      drop view if exists "analytics"."main"."qa_join_coverage__dbt_backup" cascade
    
[0m00:18:53.946048 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:18:53.948049 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */

      drop view if exists "analytics"."main"."qa_daily_completeness__dbt_backup" cascade
    
[0m00:18:53.949047 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:18:53.950555 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: Close
[0m00:18:53.952559 [debug] [Thread-1 (]: Runtime Error in model mart_flight_features (models\marts\mart_flight_features.sql)
  Catalog Error: Table with name holidays_eu does not exist!
  Did you mean "stg_weather_hourly"?
  
  LINE 24:     from "analytics"."main"."holidays_eu"
                    ^
[0m00:18:53.952559 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:18:53.953556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F9349E50>]}
[0m00:18:53.953556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA4AC2F0>]}
[0m00:18:53.956559 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: Close
[0m00:18:53.957558 [info ] [Thread-2 (]: 7 of 7 OK created sql view model main.qa_join_coverage ......................... [[32mOK[0m in 0.11s]
[0m00:18:53.957558 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model main.mart_flight_features ................ [[31mERROR[0m in 0.11s]
[0m00:18:53.958559 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e27ca09-97b0-44af-8135-7dd8822c3f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA49D010>]}
[0m00:18:53.960064 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.qa_join_coverage
[0m00:18:53.960554 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.mart_flight_features
[0m00:18:53.961590 [info ] [Thread-3 (]: 6 of 7 OK created sql view model main.qa_daily_completeness .................... [[32mOK[0m in 0.12s]
[0m00:18:53.962560 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.mart_flight_features' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_flight_features (models\marts\mart_flight_features.sql)
  Catalog Error: Table with name holidays_eu does not exist!
  Did you mean "stg_weather_hourly"?
  
  LINE 24:     from "analytics"."main"."holidays_eu"
                    ^.
[0m00:18:53.963560 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.qa_daily_completeness
[0m00:18:53.966127 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:53.966127 [debug] [MainThread]: On master: BEGIN
[0m00:18:53.967096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:53.967096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:18:53.968097 [debug] [MainThread]: On master: COMMIT
[0m00:18:53.968097 [debug] [MainThread]: Using duckdb connection "master"
[0m00:18:53.969096 [debug] [MainThread]: On master: COMMIT
[0m00:18:53.969096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:18:53.970098 [debug] [MainThread]: On master: Close
[0m00:18:53.970604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:53.971608 [debug] [MainThread]: Connection 'create_analytics_main' was properly closed.
[0m00:18:53.971608 [debug] [MainThread]: Connection 'list_analytics_main' was properly closed.
[0m00:18:53.972608 [debug] [MainThread]: Connection 'model.open_data_air_traffic.mart_flight_features' was properly closed.
[0m00:18:53.972608 [debug] [MainThread]: Connection 'model.open_data_air_traffic.qa_join_coverage' was properly closed.
[0m00:18:53.972608 [debug] [MainThread]: Connection 'model.open_data_air_traffic.qa_daily_completeness' was properly closed.
[0m00:18:53.973607 [debug] [MainThread]: Connection 'model.open_data_air_traffic.int_flights_with_weather' was properly closed.
[0m00:18:53.973607 [info ] [MainThread]: 
[0m00:18:53.974607 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:18:53.976608 [debug] [MainThread]: Command end result
[0m00:18:54.004064 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:18:54.008065 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:18:54.015614 [debug] [MainThread]: Wrote artifact RunExecutionResult to H:\Bureau\Pro\Ecole\Open Data\dbt\target\run_results.json
[0m00:18:54.015614 [info ] [MainThread]: 
[0m00:18:54.016583 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:54.016583 [info ] [MainThread]: 
[0m00:18:54.017622 [error] [MainThread]: [31mFailure in model mart_flight_features (models\marts\mart_flight_features.sql)[0m
[0m00:18:54.018586 [error] [MainThread]:   Runtime Error in model mart_flight_features (models\marts\mart_flight_features.sql)
  Catalog Error: Table with name holidays_eu does not exist!
  Did you mean "stg_weather_hourly"?
  
  LINE 24:     from "analytics"."main"."holidays_eu"
                    ^
[0m00:18:54.018586 [info ] [MainThread]: 
[0m00:18:54.020124 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\marts\mart_flight_features.sql
[0m00:18:54.021130 [info ] [MainThread]: 
[0m00:18:54.022130 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m00:18:54.023130 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:18:54.024131 [debug] [MainThread]: Command `dbt run` failed at 00:18:54.024131 after 2.32 seconds
[0m00:18:54.025131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8F2F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F6C52A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F69E2BA0>]}
[0m00:18:54.025131 [debug] [MainThread]: Flushing usage events
[0m00:18:54.468650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:33.487340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C7E04350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CAAAA8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CAAA83B0>]}


============================== 00:19:33.492852 | 1b33165c-0b1f-4a6f-8307-6c3295767abb ==============================
[0m00:19:33.492852 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:19:33.493852 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt\\logs'}
[0m00:19:33.778569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C84A2630>]}
[0m00:19:33.857364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CC56D220>]}
[0m00:19:33.859838 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:19:34.247949 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:19:34.408338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:34.409846 [debug] [MainThread]: Partial parsing: updated file: open_data_air_traffic://models\staging\_staging.yml
[0m00:19:34.894244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CCCDEED0>]}
[0m00:19:34.984397 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:19:34.987397 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:19:35.060031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CB16F0B0>]}
[0m00:19:35.060031 [info ] [MainThread]: Found 7 models, 1 seed, 5 data tests, 472 macros
[0m00:19:35.061041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CC156F60>]}
[0m00:19:35.063038 [info ] [MainThread]: 
[0m00:19:35.064214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:35.064214 [info ] [MainThread]: 
[0m00:19:35.065221 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:19:35.071233 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m00:19:35.168936 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m00:19:35.169937 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m00:19:35.169937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:35.192868 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m00:19:35.194867 [debug] [ThreadPool]: On list_analytics: Close
[0m00:19:35.195869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main)
[0m00:19:35.195869 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main"
"
[0m00:19:35.203385 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:19:35.204385 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m00:19:35.204385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:35.205890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:35.206897 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:19:35.207897 [debug] [ThreadPool]: On create_analytics_main: BEGIN
[0m00:19:35.207897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:35.208897 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:19:35.208897 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
    
        create schema if not exists "analytics"."main"
    
[0m00:19:35.210402 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:35.211407 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:19:35.211407 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:19:35.212414 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:19:35.213415 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:19:35.213415 [debug] [ThreadPool]: On create_analytics_main: Close
[0m00:19:35.215415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_main'
[0m00:19:35.221018 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:19:35.222016 [debug] [ThreadPool]: On list_analytics_main: BEGIN
[0m00:19:35.222984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:35.223983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:19:35.223983 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:19:35.224984 [debug] [ThreadPool]: On list_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics_main"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics'
  
[0m00:19:35.244349 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:19:35.247574 [debug] [ThreadPool]: On list_analytics_main: ROLLBACK
[0m00:19:35.248571 [debug] [ThreadPool]: Failed to rollback 'list_analytics_main'
[0m00:19:35.248571 [debug] [ThreadPool]: On list_analytics_main: Close
[0m00:19:35.251151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CCF8F1D0>]}
[0m00:19:35.252143 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:35.252143 [debug] [MainThread]: On master: BEGIN
[0m00:19:35.253142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:35.253142 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:19:35.254117 [debug] [MainThread]: On master: COMMIT
[0m00:19:35.254117 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:35.255113 [debug] [MainThread]: On master: COMMIT
[0m00:19:35.256113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:35.256113 [debug] [MainThread]: On master: Close
[0m00:19:35.261228 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.stg_airports
[0m00:19:35.261228 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.stg_opensky_flights
[0m00:19:35.262263 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.stg_weather_hourly
[0m00:19:35.262263 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_airports .................................. [RUN]
[0m00:19:35.263263 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_opensky_flights ........................... [RUN]
[0m00:19:35.264258 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_weather_hourly ............................ [RUN]
[0m00:19:35.265233 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_airports'
[0m00:19:35.266232 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_opensky_flights'
[0m00:19:35.266232 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_weather_hourly'
[0m00:19:35.267233 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.stg_airports
[0m00:19:35.268233 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.stg_opensky_flights
[0m00:19:35.268233 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.stg_weather_hourly
[0m00:19:35.277737 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_airports"
[0m00:19:35.281342 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.284312 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.286312 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.stg_airports
[0m00:19:35.323619 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_airports"
[0m00:19:35.324652 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.stg_opensky_flights
[0m00:19:35.324652 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.stg_weather_hourly
[0m00:19:35.328618 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.332161 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.333161 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:19:35.334132 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.334132 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: BEGIN
[0m00:19:35.335131 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: BEGIN
[0m00:19:35.336131 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.336551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:35.337583 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:19:35.337583 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: BEGIN
[0m00:19:35.338583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.340089 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.340089 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:19:35.341095 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:19:35.341095 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.342255 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('../data/reference/airports_eu.csv')
  );

[0m00:19:35.343261 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.343261 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        '../data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m00:19:35.344261 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.345260 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        '../data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m00:19:35.348260 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m00:19:35.349299 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.355817 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.356809 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:19:35.359810 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.360522 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */
alter view "analytics"."main"."stg_opensky_flights" rename to "stg_opensky_flights__dbt_backup"
[0m00:19:35.364557 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:19:35.365529 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */
alter view "analytics"."main"."stg_weather_hourly" rename to "stg_weather_hourly__dbt_backup"
[0m00:19:35.366529 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */
alter view "analytics"."main"."stg_airports" rename to "stg_airports__dbt_backup"
[0m00:19:35.367527 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.371039 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.371039 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:19:35.372039 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:19:35.373039 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */
alter view "analytics"."main"."stg_opensky_flights__dbt_tmp" rename to "stg_opensky_flights"
[0m00:19:35.376069 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.380069 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:19:35.380577 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */
alter view "analytics"."main"."stg_weather_hourly__dbt_tmp" rename to "stg_weather_hourly"
[0m00:19:35.381624 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.381624 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */
alter view "analytics"."main"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m00:19:35.395388 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: COMMIT
[0m00:19:35.396419 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m00:19:35.397421 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.397421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.399894 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: COMMIT
[0m00:19:35.399894 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: COMMIT
[0m00:19:35.401901 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: COMMIT
[0m00:19:35.402913 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.403907 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:19:35.404943 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: COMMIT
[0m00:19:35.405941 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: COMMIT
[0m00:19:35.407392 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m00:19:35.413908 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:19:35.413908 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m00:19:35.414900 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m00:19:35.414900 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

      drop view if exists "analytics"."main"."stg_opensky_flights__dbt_backup" cascade
    
[0m00:19:35.417900 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:19:35.421088 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:19:35.422088 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

      drop view if exists "analytics"."main"."stg_weather_hourly__dbt_backup" cascade
    
[0m00:19:35.422088 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

      drop view if exists "analytics"."main"."stg_airports__dbt_backup" cascade
    
[0m00:19:35.424756 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.426970 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: Close
[0m00:19:35.427941 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:19:35.429971 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:19:35.431512 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: Close
[0m00:19:35.432482 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: Close
[0m00:19:35.433482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CCF8F9E0>]}
[0m00:19:35.434485 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CD0742F0>]}
[0m00:19:35.434485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CCF8FAD0>]}
[0m00:19:35.436484 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_opensky_flights ...................... [[32mOK[0m in 0.16s]
[0m00:19:35.437483 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_weather_hourly ....................... [[32mOK[0m in 0.17s]
[0m00:19:35.437483 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_airports ............................. [[32mOK[0m in 0.17s]
[0m00:19:35.438483 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.stg_opensky_flights
[0m00:19:35.439989 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.stg_weather_hourly
[0m00:19:35.439989 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.stg_airports
[0m00:19:35.441995 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.int_flights_with_weather
[0m00:19:35.442995 [info ] [Thread-1 (]: 4 of 7 START sql view model main.int_flights_with_weather ...................... [RUN]
[0m00:19:35.443376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_airports, now model.open_data_air_traffic.int_flights_with_weather)
[0m00:19:35.444383 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.int_flights_with_weather
[0m00:19:35.447411 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.448382 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.int_flights_with_weather
[0m00:19:35.452894 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.453892 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.454895 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: BEGIN
[0m00:19:35.455895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:35.456896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.457895 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.457895 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */

  
  create view "analytics"."main"."int_flights_with_weather__dbt_tmp" as (
    with flights as (
    select *
    from "analytics"."main"."stg_opensky_flights"
),
weather as (
    select *
    from "analytics"."main"."stg_weather_hourly"
)

select
    f.*,
    case
        when f.flight_type = 'departure' then f.first_seen_hour_utc
        else f.last_seen_hour_utc
    end as event_hour_utc,
    w.temperature_2m,
    w.precipitation,
    w.wind_speed_10m,
    w.cloud_cover
from flights f
left join weather w
    on w.airport_icao = f.airport_icao
   and w.time_utc = case
        when f.flight_type = 'departure' then f.first_seen_hour_utc
        else f.last_seen_hour_utc
    end
  );

[0m00:19:35.464089 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:19:35.467094 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.468089 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */
alter view "analytics"."main"."int_flights_with_weather" rename to "int_flights_with_weather__dbt_backup"
[0m00:19:35.469059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:35.474577 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.474577 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */
alter view "analytics"."main"."int_flights_with_weather__dbt_tmp" rename to "int_flights_with_weather"
[0m00:19:35.475578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:19:35.478578 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: COMMIT
[0m00:19:35.478578 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.478578 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: COMMIT
[0m00:19:35.483090 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.486090 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:19:35.487090 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */

      drop view if exists "analytics"."main"."int_flights_with_weather__dbt_backup" cascade
    
[0m00:19:35.490184 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:19:35.491193 [debug] [Thread-1 (]: On model.open_data_air_traffic.int_flights_with_weather: Close
[0m00:19:35.492192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CE0DE6F0>]}
[0m00:19:35.493192 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.int_flights_with_weather ................. [[32mOK[0m in 0.05s]
[0m00:19:35.494193 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.int_flights_with_weather
[0m00:19:35.495191 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.mart_flight_features
[0m00:19:35.495191 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.qa_daily_completeness
[0m00:19:35.496190 [debug] [Thread-4 (]: Began running node model.open_data_air_traffic.qa_join_coverage
[0m00:19:35.496190 [info ] [Thread-2 (]: 5 of 7 START sql table model main.mart_flight_features ......................... [RUN]
[0m00:19:35.497192 [info ] [Thread-3 (]: 6 of 7 START sql view model main.qa_daily_completeness ......................... [RUN]
[0m00:19:35.498191 [info ] [Thread-4 (]: 7 of 7 START sql view model main.qa_join_coverage .............................. [RUN]
[0m00:19:35.499193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_opensky_flights, now model.open_data_air_traffic.mart_flight_features)
[0m00:19:35.499193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_weather_hourly, now model.open_data_air_traffic.qa_daily_completeness)
[0m00:19:35.500193 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.qa_join_coverage'
[0m00:19:35.500193 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.mart_flight_features
[0m00:19:35.501320 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.qa_daily_completeness
[0m00:19:35.502317 [debug] [Thread-4 (]: Began compiling node model.open_data_air_traffic.qa_join_coverage
[0m00:19:35.505831 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.mart_flight_features"
[0m00:19:35.508839 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.512962 [debug] [Thread-4 (]: Writing injected SQL for node "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.514959 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.mart_flight_features
[0m00:19:35.529982 [debug] [Thread-4 (]: Began executing node model.open_data_air_traffic.qa_join_coverage
[0m00:19:35.536992 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.mart_flight_features"
[0m00:19:35.537992 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.qa_daily_completeness
[0m00:19:35.541330 [debug] [Thread-4 (]: Writing runtime sql for node "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.546333 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.547330 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:19:35.547330 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.548331 [debug] [Thread-2 (]: On model.open_data_air_traffic.mart_flight_features: BEGIN
[0m00:19:35.548331 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: BEGIN
[0m00:19:35.549838 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.549838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:19:35.550847 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:19:35.550847 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: BEGIN
[0m00:19:35.551846 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:19:35.552849 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:19:35.552849 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:19:35.553848 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:19:35.554847 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.554847 [debug] [Thread-2 (]: On model.open_data_air_traffic.mart_flight_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */

  
    
    

    create  table
      "analytics"."main"."mart_flight_features__dbt_tmp"
  
    as (
      with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
),
airports as (
    select *
    from "analytics"."main"."stg_airports"
),
holidays as (
    select
        cast(date as date) as holiday_date,
        upper(country_code) as country_code,
        is_holiday
    from "analytics"."main"."holidays_eu"
)

select
    f.icao24,
    f.callsign,
    f.flight_type,
    f.airport_icao,
    f.est_departure_airport,
    f.est_arrival_airport,
    f.first_seen_ts_utc,
    f.last_seen_ts_utc,
    f.event_hour_utc,
    date_diff('minute', f.first_seen_ts_utc, f.last_seen_ts_utc) as flight_duration_min,
    extract('hour' from f.event_hour_utc) as hour_of_day_utc,
    extract('dow' from f.event_hour_utc) as day_of_week_utc,
    extract('month' from f.event_hour_utc) as month_utc,
    extract('week' from f.event_hour_utc) as week_of_year_utc,
    extract('doy' from f.event_hour_utc) as day_of_year_utc,
    case when extract('dow' from f.event_hour_utc) in (0, 6) then true else false end as is_weekend_utc,
    f.temperature_2m,
    f.precipitation,
    f.wind_speed_10m,
    f.cloud_cover,
    a.country_code as airport_country_code,
    concat(f.est_departure_airport, '-', f.est_arrival_airport) as route_code,
    coalesce(h.is_holiday, false) as is_holiday
from flights f
left join airports a
    on a.icao = f.airport_icao
left join holidays h
    on h.country_code = a.country_code
   and h.holiday_date = cast(f.event_hour_utc as date)
    );
  
  
[0m00:19:35.555848 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.556847 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */

  
  create view "analytics"."main"."qa_join_coverage__dbt_tmp" as (
    with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
)

select
    date_trunc('day', event_hour_utc) as day_utc,
    count(*) as flights_total,
    count(*) filter (where temperature_2m is not null) as flights_with_weather,
    round(
        100.0 * count(*) filter (where temperature_2m is not null) / nullif(count(*), 0),
        2
    ) as pct_with_weather
from flights
group by 1
  );

[0m00:19:35.557847 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.558847 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */

  
  create view "analytics"."main"."qa_daily_completeness__dbt_tmp" as (
    with flights as (
    select
        airport_icao,
        date_trunc('day', event_hour_utc) as day_utc,
        count(*) as flights_count
    from "analytics"."main"."int_flights_with_weather"
    group by 1, 2
),
weather as (
    select
        airport_icao,
        date_trunc('day', time_utc) as day_utc,
        count(*) as weather_hours_count
    from "analytics"."main"."stg_weather_hourly"
    group by 1, 2
)

select
    coalesce(f.airport_icao, w.airport_icao) as airport_icao,
    coalesce(f.day_utc, w.day_utc) as day_utc,
    coalesce(f.flights_count, 0) as flights_count,
    coalesce(w.weather_hours_count, 0) as weather_hours_count,
    case
        when coalesce(w.weather_hours_count, 0) >= 24 then 0
        else 24 - coalesce(w.weather_hours_count, 0)
    end as missing_weather_hours
from flights f
full join weather w
    on f.airport_icao = w.airport_icao
   and f.day_utc = w.day_utc
  );

[0m00:19:35.565370 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m00:19:35.568369 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.568369 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m00:19:35.569878 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */
alter view "analytics"."main"."qa_join_coverage" rename to "qa_join_coverage__dbt_backup"
[0m00:19:35.570885 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */

  
    
    

    create  table
      "analytics"."main"."mart_flight_features__dbt_tmp"
  
    as (
      with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
),
airports as (
    select *
    from "analytics"."main"."stg_airports"
),
holidays as (
    select
        cast(date as date) as holiday_date,
        upper(country_code) as country_code,
        is_holiday
    from "analytics"."main"."holidays_eu"
)

select
    f.icao24,
    f.callsign,
    f.flight_type,
    f.airport_icao,
    f.est_departure_airport,
    f.est_arrival_airport,
    f.first_seen_ts_utc,
    f.last_seen_ts_utc,
    f.event_hour_utc,
    date_diff('minute', f.first_seen_ts_utc, f.last_seen_ts_utc) as flight_duration_min,
    extract('hour' from f.event_hour_utc) as hour_of_day_utc,
    extract('dow' from f.event_hour_utc) as day_of_week_utc,
    extract('month' from f.event_hour_utc) as month_utc,
    extract('week' from f.event_hour_utc) as week_of_year_utc,
    extract('doy' from f.event_hour_utc) as day_of_year_utc,
    case when extract('dow' from f.event_hour_utc) in (0, 6) then true else false end as is_weekend_utc,
    f.temperature_2m,
    f.precipitation,
    f.wind_speed_10m,
    f.cloud_cover,
    a.country_code as airport_country_code,
    concat(f.est_departure_airport, '-', f.est_arrival_airport) as route_code,
    coalesce(h.is_holiday, false) as is_holiday
from flights f
left join airports a
    on a.icao = f.airport_icao
left join holidays h
    on h.country_code = a.country_code
   and h.holiday_date = cast(f.event_hour_utc as date)
    );
  
  
[0m00:19:35.573885 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.574884 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m00:19:35.575885 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.576886 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */
alter view "analytics"."main"."qa_daily_completeness" rename to "qa_daily_completeness__dbt_backup"
[0m00:19:35.576886 [debug] [Thread-2 (]: On model.open_data_air_traffic.mart_flight_features: ROLLBACK
[0m00:19:35.581998 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.583613 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */
alter view "analytics"."main"."qa_join_coverage__dbt_tmp" rename to "qa_join_coverage"
[0m00:19:35.584654 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:19:35.585622 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.588613 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.591143 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: COMMIT
[0m00:19:35.592141 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */
alter view "analytics"."main"."qa_daily_completeness__dbt_tmp" rename to "qa_daily_completeness"
[0m00:19:35.593143 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.594136 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: COMMIT
[0m00:19:35.594136 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:19:35.597136 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: COMMIT
[0m00:19:35.598136 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.598136 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.599136 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: COMMIT
[0m00:19:35.600719 [debug] [Thread-2 (]: Failed to rollback 'model.open_data_air_traffic.mart_flight_features'
[0m00:19:35.603726 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:19:35.603726 [debug] [Thread-2 (]: On model.open_data_air_traffic.mart_flight_features: Close
[0m00:19:35.604727 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */

      drop view if exists "analytics"."main"."qa_join_coverage__dbt_backup" cascade
    
[0m00:19:35.606841 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:19:35.610352 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:19:35.610352 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m00:19:35.611364 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */

      drop view if exists "analytics"."main"."qa_daily_completeness__dbt_backup" cascade
    
[0m00:19:35.612914 [debug] [Thread-4 (]: On model.open_data_air_traffic.qa_join_coverage: Close
[0m00:19:35.614497 [debug] [Thread-2 (]: Runtime Error in model mart_flight_features (models\marts\mart_flight_features.sql)
  Catalog Error: Table with name holidays_eu does not exist!
  Did you mean "qa_daily_completeness"?
  
  LINE 24:     from "analytics"."main"."holidays_eu"
                    ^
[0m00:19:35.615497 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CCF8F8C0>]}
[0m00:19:35.616340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CCF8FA10>]}
[0m00:19:35.617376 [info ] [Thread-4 (]: 7 of 7 OK created sql view model main.qa_join_coverage ......................... [[32mOK[0m in 0.12s]
[0m00:19:35.618376 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:19:35.617376 [error] [Thread-2 (]: 5 of 7 ERROR creating sql table model main.mart_flight_features ................ [[31mERROR[0m in 0.12s]
[0m00:19:35.618376 [debug] [Thread-4 (]: Finished running node model.open_data_air_traffic.qa_join_coverage
[0m00:19:35.620918 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: Close
[0m00:19:35.621887 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.mart_flight_features
[0m00:19:35.622887 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b33165c-0b1f-4a6f-8307-6c3295767abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CE100860>]}
[0m00:19:35.623887 [debug] [Thread-7 (]: Marking all children of 'model.open_data_air_traffic.mart_flight_features' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_flight_features (models\marts\mart_flight_features.sql)
  Catalog Error: Table with name holidays_eu does not exist!
  Did you mean "qa_daily_completeness"?
  
  LINE 24:     from "analytics"."main"."holidays_eu"
                    ^.
[0m00:19:35.624888 [info ] [Thread-3 (]: 6 of 7 OK created sql view model main.qa_daily_completeness .................... [[32mOK[0m in 0.12s]
[0m00:19:35.626242 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.qa_daily_completeness
[0m00:19:35.627257 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:35.628285 [debug] [MainThread]: On master: BEGIN
[0m00:19:35.628285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:35.629803 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:19:35.629803 [debug] [MainThread]: On master: COMMIT
[0m00:19:35.630819 [debug] [MainThread]: Using duckdb connection "master"
[0m00:19:35.630819 [debug] [MainThread]: On master: COMMIT
[0m00:19:35.631820 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:19:35.631820 [debug] [MainThread]: On master: Close
[0m00:19:35.632819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:35.632819 [debug] [MainThread]: Connection 'create_analytics_main' was properly closed.
[0m00:19:35.633818 [debug] [MainThread]: Connection 'list_analytics_main' was properly closed.
[0m00:19:35.633818 [debug] [MainThread]: Connection 'model.open_data_air_traffic.int_flights_with_weather' was properly closed.
[0m00:19:35.634819 [debug] [MainThread]: Connection 'model.open_data_air_traffic.mart_flight_features' was properly closed.
[0m00:19:35.634819 [debug] [MainThread]: Connection 'model.open_data_air_traffic.qa_daily_completeness' was properly closed.
[0m00:19:35.635818 [debug] [MainThread]: Connection 'model.open_data_air_traffic.qa_join_coverage' was properly closed.
[0m00:19:35.635818 [info ] [MainThread]: 
[0m00:19:35.636820 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m00:19:35.639810 [debug] [MainThread]: Command end result
[0m00:19:35.666098 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:19:35.669058 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:19:35.676364 [debug] [MainThread]: Wrote artifact RunExecutionResult to H:\Bureau\Pro\Ecole\Open Data\dbt\target\run_results.json
[0m00:19:35.676364 [info ] [MainThread]: 
[0m00:19:35.677358 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:19:35.678370 [info ] [MainThread]: 
[0m00:19:35.678370 [error] [MainThread]: [31mFailure in model mart_flight_features (models\marts\mart_flight_features.sql)[0m
[0m00:19:35.679884 [error] [MainThread]:   Runtime Error in model mart_flight_features (models\marts\mart_flight_features.sql)
  Catalog Error: Table with name holidays_eu does not exist!
  Did you mean "qa_daily_completeness"?
  
  LINE 24:     from "analytics"."main"."holidays_eu"
                    ^
[0m00:19:35.680897 [info ] [MainThread]: 
[0m00:19:35.680897 [info ] [MainThread]:   compiled code at target\compiled\open_data_air_traffic\models\marts\mart_flight_features.sql
[0m00:19:35.681897 [info ] [MainThread]: 
[0m00:19:35.682890 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m00:19:35.683898 [debug] [MainThread]: Command `dbt run` failed at 00:19:35.683898 after 2.33 seconds
[0m00:19:35.684891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CA764BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CA764FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CAC0C4A0>]}
[0m00:19:35.685890 [debug] [MainThread]: Flushing usage events
[0m00:19:36.120201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:15.755588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99FA304D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99FA30560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99F472480>]}


============================== 00:20:15.761106 | 5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f ==============================
[0m00:20:15.761106 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:20:15.762106 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt\\logs'}
[0m00:20:16.049935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99FE3EAB0>]}
[0m00:20:16.126677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A0FEC1A0>]}
[0m00:20:16.130202 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:20:16.512937 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:20:16.675710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:20:16.676712 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:20:16.676712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:20:16.731029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99FEA5F70>]}
[0m00:20:16.823364 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:20:16.826365 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:20:16.851932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A15F70B0>]}
[0m00:20:16.851932 [info ] [MainThread]: Found 7 models, 1 seed, 5 data tests, 472 macros
[0m00:20:16.852931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A1979280>]}
[0m00:20:16.855273 [info ] [MainThread]: 
[0m00:20:16.856243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:20:16.857569 [info ] [MainThread]: 
[0m00:20:16.858568 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:20:16.858568 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m00:20:16.980750 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m00:20:16.981789 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m00:20:16.981789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:17.001844 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:20:17.003814 [debug] [ThreadPool]: On list_analytics: Close
[0m00:20:17.004813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main)
[0m00:20:17.005813 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main"
"
[0m00:20:17.012890 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:17.013889 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m00:20:17.013889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:17.014860 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:20:17.016859 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:17.016859 [debug] [ThreadPool]: On create_analytics_main: BEGIN
[0m00:20:17.017860 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:20:17.018902 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:17.018902 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
    
        create schema if not exists "analytics"."main"
    
[0m00:20:17.019863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:20:17.021081 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:20:17.021081 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:17.022082 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:20:17.022082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:20:17.023081 [debug] [ThreadPool]: On create_analytics_main: Close
[0m00:20:17.029111 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_main'
[0m00:20:17.034630 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:20:17.035624 [debug] [ThreadPool]: On list_analytics_main: BEGIN
[0m00:20:17.035624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:17.036624 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:20:17.036624 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:20:17.037598 [debug] [ThreadPool]: On list_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics_main"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics'
  
[0m00:20:17.053193 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:20:17.054223 [debug] [ThreadPool]: On list_analytics_main: ROLLBACK
[0m00:20:17.056195 [debug] [ThreadPool]: Failed to rollback 'list_analytics_main'
[0m00:20:17.056732 [debug] [ThreadPool]: On list_analytics_main: Close
[0m00:20:17.058736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A191D760>]}
[0m00:20:17.058736 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:17.058736 [debug] [MainThread]: On master: BEGIN
[0m00:20:17.060242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:17.061247 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:20:17.061247 [debug] [MainThread]: On master: COMMIT
[0m00:20:17.062246 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:17.062246 [debug] [MainThread]: On master: COMMIT
[0m00:20:17.063247 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:20:17.063247 [debug] [MainThread]: On master: Close
[0m00:20:17.068250 [debug] [Thread-1 (]: Began running node seed.open_data_air_traffic.holidays_eu
[0m00:20:17.069250 [info ] [Thread-1 (]: 1 of 1 START seed file main.holidays_eu ........................................ [RUN]
[0m00:20:17.070250 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.open_data_air_traffic.holidays_eu'
[0m00:20:17.071407 [debug] [Thread-1 (]: Began compiling node seed.open_data_air_traffic.holidays_eu
[0m00:20:17.072404 [debug] [Thread-1 (]: Began executing node seed.open_data_air_traffic.holidays_eu
[0m00:20:17.101943 [debug] [Thread-1 (]: Using duckdb connection "seed.open_data_air_traffic.holidays_eu"
[0m00:20:17.102942 [debug] [Thread-1 (]: On seed.open_data_air_traffic.holidays_eu: BEGIN
[0m00:20:17.102942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:17.103942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:20:17.104971 [debug] [Thread-1 (]: Using duckdb connection "seed.open_data_air_traffic.holidays_eu"
[0m00:20:17.104971 [debug] [Thread-1 (]: On seed.open_data_air_traffic.holidays_eu: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "seed.open_data_air_traffic.holidays_eu"} */

    create table "analytics"."main"."holidays_eu" ("date" date,"country_code" text,"is_holiday" boolean,"holiday_name" text)
  
[0m00:20:17.114451 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m00:20:17.126989 [debug] [Thread-1 (]: Using duckdb connection "seed.open_data_air_traffic.holidays_eu"
[0m00:20:17.127963 [debug] [Thread-1 (]: On seed.open_data_air_traffic.holidays_eu: 
          COPY "analytics"."main"."holidays_eu" FROM 'H:\Bureau\Pro\Ecole\Open Data\dbt\seeds\holidays_eu.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m00:20:17.160487 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m00:20:17.167489 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.open_data_air_traffic.holidays_eu"
[0m00:20:17.183580 [debug] [Thread-1 (]: On seed.open_data_air_traffic.holidays_eu: COMMIT
[0m00:20:17.184577 [debug] [Thread-1 (]: Using duckdb connection "seed.open_data_air_traffic.holidays_eu"
[0m00:20:17.184577 [debug] [Thread-1 (]: On seed.open_data_air_traffic.holidays_eu: COMMIT
[0m00:20:17.191123 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:20:17.193124 [debug] [Thread-1 (]: On seed.open_data_air_traffic.holidays_eu: Close
[0m00:20:17.196124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe98c01-ef2f-498f-ad0d-3d9ad8e7390f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99CD583E0>]}
[0m00:20:17.196124 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.holidays_eu .................................... [[32mINSERT 1[0m in 0.12s]
[0m00:20:17.198122 [debug] [Thread-1 (]: Finished running node seed.open_data_air_traffic.holidays_eu
[0m00:20:17.200121 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:17.200658 [debug] [MainThread]: On master: BEGIN
[0m00:20:17.200658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:17.201660 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:20:17.201660 [debug] [MainThread]: On master: COMMIT
[0m00:20:17.202661 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:17.202661 [debug] [MainThread]: On master: COMMIT
[0m00:20:17.203659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:20:17.203659 [debug] [MainThread]: On master: Close
[0m00:20:17.204659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:17.205660 [debug] [MainThread]: Connection 'create_analytics_main' was properly closed.
[0m00:20:17.205660 [debug] [MainThread]: Connection 'list_analytics_main' was properly closed.
[0m00:20:17.205660 [debug] [MainThread]: Connection 'seed.open_data_air_traffic.holidays_eu' was properly closed.
[0m00:20:17.206659 [info ] [MainThread]: 
[0m00:20:17.207661 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m00:20:17.208664 [debug] [MainThread]: Command end result
[0m00:20:17.235201 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:20:17.239201 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:20:17.245746 [debug] [MainThread]: Wrote artifact RunExecutionResult to H:\Bureau\Pro\Ecole\Open Data\dbt\target\run_results.json
[0m00:20:17.246749 [info ] [MainThread]: 
[0m00:20:17.246749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:17.247715 [info ] [MainThread]: 
[0m00:20:17.248742 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:20:17.250247 [debug] [MainThread]: Command `dbt seed` succeeded at 00:20:17.250247 after 1.63 seconds
[0m00:20:17.250247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99F1E9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99F8449B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99F844F80>]}
[0m00:20:17.251252 [debug] [MainThread]: Flushing usage events
[0m00:20:17.615000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:21.950599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AFC36180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AC44CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AEEF9130>]}


============================== 00:20:21.956602 | 424eccaf-9fe9-4b63-a4fc-a49267b91f6c ==============================
[0m00:20:21.956602 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:20:21.957131 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'H:\\Bureau\\Pro\\Ecole\\Open Data\\dbt\\logs'}
[0m00:20:22.242704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ACE455E0>]}
[0m00:20:22.316190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B10E09B0>]}
[0m00:20:22.319187 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:20:22.700896 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:20:22.857064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:20:22.857064 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:20:22.858033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:20:22.910415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B112C530>]}
[0m00:20:23.000114 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:20:23.003352 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:20:23.025369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1A5DFD0>]}
[0m00:20:23.026370 [info ] [MainThread]: Found 7 models, 1 seed, 5 data tests, 472 macros
[0m00:20:23.026831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1644350>]}
[0m00:20:23.028465 [info ] [MainThread]: 
[0m00:20:23.030006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:20:23.030006 [info ] [MainThread]: 
[0m00:20:23.031011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:20:23.037012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m00:20:23.135235 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m00:20:23.136235 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m00:20:23.137234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:23.156347 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:20:23.157350 [debug] [ThreadPool]: On list_analytics: Close
[0m00:20:23.158347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main)
[0m00:20:23.158347 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main"
"
[0m00:20:23.166418 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:23.167418 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m00:20:23.167418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:23.168419 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:20:23.169924 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:23.170930 [debug] [ThreadPool]: On create_analytics_main: BEGIN
[0m00:20:23.170930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:20:23.171930 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:23.172930 [debug] [ThreadPool]: On create_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "create_analytics_main"} */

    
    
        create schema if not exists "analytics"."main"
    
[0m00:20:23.173574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:20:23.174580 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:20:23.174580 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main"
[0m00:20:23.175579 [debug] [ThreadPool]: On create_analytics_main: COMMIT
[0m00:20:23.176579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:20:23.176579 [debug] [ThreadPool]: On create_analytics_main: Close
[0m00:20:23.179055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_main'
[0m00:20:23.185072 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:20:23.185072 [debug] [ThreadPool]: On list_analytics_main: BEGIN
[0m00:20:23.186072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:23.186072 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:20:23.187072 [debug] [ThreadPool]: Using duckdb connection "list_analytics_main"
[0m00:20:23.188072 [debug] [ThreadPool]: On list_analytics_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "connection_name": "list_analytics_main"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics'
  
[0m00:20:23.204101 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:20:23.206102 [debug] [ThreadPool]: On list_analytics_main: ROLLBACK
[0m00:20:23.208101 [debug] [ThreadPool]: Failed to rollback 'list_analytics_main'
[0m00:20:23.208101 [debug] [ThreadPool]: On list_analytics_main: Close
[0m00:20:23.210828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B16583B0>]}
[0m00:20:23.210828 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:23.211826 [debug] [MainThread]: On master: BEGIN
[0m00:20:23.211826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:23.212828 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:20:23.212828 [debug] [MainThread]: On master: COMMIT
[0m00:20:23.213825 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:23.213825 [debug] [MainThread]: On master: COMMIT
[0m00:20:23.214825 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:20:23.215825 [debug] [MainThread]: On master: Close
[0m00:20:23.220902 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.stg_airports
[0m00:20:23.220902 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.stg_opensky_flights
[0m00:20:23.221904 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.stg_weather_hourly
[0m00:20:23.222907 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_airports .................................. [RUN]
[0m00:20:23.223905 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg_opensky_flights ........................... [RUN]
[0m00:20:23.223905 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg_weather_hourly ............................ [RUN]
[0m00:20:23.224904 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_airports'
[0m00:20:23.225906 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_opensky_flights'
[0m00:20:23.225906 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.stg_weather_hourly'
[0m00:20:23.226903 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.stg_airports
[0m00:20:23.227904 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.stg_opensky_flights
[0m00:20:23.227904 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.stg_weather_hourly
[0m00:20:23.236419 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_airports"
[0m00:20:23.239961 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.242967 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.243968 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.stg_airports
[0m00:20:23.265070 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.stg_opensky_flights
[0m00:20:23.265070 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.stg_weather_hourly
[0m00:20:23.282105 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_airports"
[0m00:20:23.286134 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.290610 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.291617 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:20:23.292617 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.292617 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: BEGIN
[0m00:20:23.293617 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.293617 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: BEGIN
[0m00:20:23.294613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:23.295615 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: BEGIN
[0m00:20:23.295615 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:20:23.296614 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:20:23.297813 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.298824 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.298824 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:20:23.299820 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:20:23.299820 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.301016 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.301016 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

  
  create view "analytics"."main"."stg_airports__dbt_tmp" as (
    select
    upper(icao) as icao,
    latitude,
    longitude,
    coalesce(timezone, 'UTC') as timezone,
    upper(country_code) as country_code
from read_csv_auto('../data/reference/airports_eu.csv')
  );

[0m00:20:23.302044 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

  
  create view "analytics"."main"."stg_opensky_flights__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        '../data/raw/opensky/*/*.jsonl',
        union_by_name=true
    )
)

select
    icao24,
    trim(callsign) as callsign,
    estDepartureAirport as est_departure_airport,
    estArrivalAirport as est_arrival_airport,
    firstSeen as first_seen,
    lastSeen as last_seen,
    estDepartureAirportHorizDistance as est_departure_airport_horiz_distance,
    estDepartureAirportVertDistance as est_departure_airport_vert_distance,
    estArrivalAirportHorizDistance as est_arrival_airport_horiz_distance,
    estArrivalAirportVertDistance as est_arrival_airport_vert_distance,
    departureAirportCandidatesCount as departure_airport_candidates_count,
    arrivalAirportCandidatesCount as arrival_airport_candidates_count,
    flight_type,
    airport_icao,
    to_timestamp(firstSeen) as first_seen_ts_utc,
    to_timestamp(lastSeen) as last_seen_ts_utc,
    date_trunc('hour', to_timestamp(firstSeen)) as first_seen_hour_utc,
    date_trunc('hour', to_timestamp(lastSeen)) as last_seen_hour_utc
from raw
  );

[0m00:20:23.303015 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

  
  create view "analytics"."main"."stg_weather_hourly__dbt_tmp" as (
    with raw as (
    select *
    from read_json_auto(
        '../data/raw/weather/*/*.json',
        union_by_name=true
    )
),
expanded as (
    select
        airport_icao,
        timezone,
        hourly.time as time_list,
        hourly.temperature_2m as temperature_2m_list,
        hourly.precipitation as precipitation_list,
        hourly.wind_speed_10m as wind_speed_10m_list,
        hourly.cloud_cover as cloud_cover_list
    from raw
)

select
    airport_icao,
    coalesce(timezone, 'UTC') as timezone,
    list_extract(time_list, i) as time_local,
    strptime(list_extract(time_list, i), '%Y-%m-%dT%H:%M') as time_utc,
    list_extract(temperature_2m_list, i) as temperature_2m,
    list_extract(precipitation_list, i) as precipitation,
    list_extract(wind_speed_10m_list, i) as wind_speed_10m,
    list_extract(cloud_cover_list, i) as cloud_cover
from expanded, range(0, list_count(time_list)) as t(i)
  );

[0m00:20:23.307015 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.307015 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.314534 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.314534 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:20:23.318560 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.318560 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */
alter view "analytics"."main"."stg_opensky_flights" rename to "stg_opensky_flights__dbt_backup"
[0m00:20:23.322100 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:20:23.323101 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */
alter view "analytics"."main"."stg_weather_hourly" rename to "stg_weather_hourly__dbt_backup"
[0m00:20:23.324071 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */
alter view "analytics"."main"."stg_airports" rename to "stg_airports__dbt_backup"
[0m00:20:23.325070 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.326073 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:20:23.326073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.329070 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.332326 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.335331 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:20:23.336326 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */
alter view "analytics"."main"."stg_opensky_flights__dbt_tmp" rename to "stg_opensky_flights"
[0m00:20:23.337297 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */
alter view "analytics"."main"."stg_weather_hourly__dbt_tmp" rename to "stg_weather_hourly"
[0m00:20:23.337297 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */
alter view "analytics"."main"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m00:20:23.338327 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:20:23.339536 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.353135 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: COMMIT
[0m00:20:23.353135 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m00:20:23.355105 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: COMMIT
[0m00:20:23.356122 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.358130 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: COMMIT
[0m00:20:23.358130 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.359158 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: COMMIT
[0m00:20:23.360129 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:20:23.360640 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: COMMIT
[0m00:20:23.360640 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: COMMIT
[0m00:20:23.364204 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.371713 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.stg_opensky_flights"
[0m00:20:23.371713 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m00:20:23.372713 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m00:20:23.373712 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_opensky_flights"} */

      drop view if exists "analytics"."main"."stg_opensky_flights__dbt_backup" cascade
    
[0m00:20:23.375713 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.stg_airports"
[0m00:20:23.378715 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.stg_weather_hourly"
[0m00:20:23.378715 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_airports"} */

      drop view if exists "analytics"."main"."stg_airports__dbt_backup" cascade
    
[0m00:20:23.380252 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.stg_weather_hourly"} */

      drop view if exists "analytics"."main"."stg_weather_hourly__dbt_backup" cascade
    
[0m00:20:23.382896 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.384902 [debug] [Thread-2 (]: On model.open_data_air_traffic.stg_opensky_flights: Close
[0m00:20:23.385902 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:20:23.387932 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m00:20:23.389901 [debug] [Thread-1 (]: On model.open_data_air_traffic.stg_airports: Close
[0m00:20:23.391007 [debug] [Thread-3 (]: On model.open_data_air_traffic.stg_weather_hourly: Close
[0m00:20:23.392006 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1ED5A30>]}
[0m00:20:23.392006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1EBFEC0>]}
[0m00:20:23.393004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1F14890>]}
[0m00:20:23.394003 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg_opensky_flights ...................... [[32mOK[0m in 0.16s]
[0m00:20:23.395004 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_airports ............................. [[32mOK[0m in 0.17s]
[0m00:20:23.395004 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg_weather_hourly ....................... [[32mOK[0m in 0.17s]
[0m00:20:23.396004 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.stg_opensky_flights
[0m00:20:23.397005 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.stg_airports
[0m00:20:23.398002 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.stg_weather_hourly
[0m00:20:23.399002 [debug] [Thread-4 (]: Began running node model.open_data_air_traffic.int_flights_with_weather
[0m00:20:23.400005 [info ] [Thread-4 (]: 4 of 7 START sql view model main.int_flights_with_weather ...................... [RUN]
[0m00:20:23.400005 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.open_data_air_traffic.int_flights_with_weather'
[0m00:20:23.401069 [debug] [Thread-4 (]: Began compiling node model.open_data_air_traffic.int_flights_with_weather
[0m00:20:23.404068 [debug] [Thread-4 (]: Writing injected SQL for node "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.406069 [debug] [Thread-4 (]: Began executing node model.open_data_air_traffic.int_flights_with_weather
[0m00:20:23.409068 [debug] [Thread-4 (]: Writing runtime sql for node "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.410573 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.410573 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: BEGIN
[0m00:20:23.411580 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:20:23.412585 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.412585 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.413586 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */

  
  create view "analytics"."main"."int_flights_with_weather__dbt_tmp" as (
    with flights as (
    select *
    from "analytics"."main"."stg_opensky_flights"
),
weather as (
    select *
    from "analytics"."main"."stg_weather_hourly"
)

select
    f.*,
    case
        when f.flight_type = 'departure' then f.first_seen_hour_utc
        else f.last_seen_hour_utc
    end as event_hour_utc,
    w.temperature_2m,
    w.precipitation,
    w.wind_speed_10m,
    w.cloud_cover
from flights f
left join weather w
    on w.airport_icao = f.airport_icao
   and w.time_utc = case
        when f.flight_type = 'departure' then f.first_seen_hour_utc
        else f.last_seen_hour_utc
    end
  );

[0m00:20:23.418615 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m00:20:23.423157 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.424185 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */
alter view "analytics"."main"."int_flights_with_weather" rename to "int_flights_with_weather__dbt_backup"
[0m00:20:23.425185 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:20:23.428186 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.429160 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */
alter view "analytics"."main"."int_flights_with_weather__dbt_tmp" rename to "int_flights_with_weather"
[0m00:20:23.430156 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:20:23.431666 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: COMMIT
[0m00:20:23.432666 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.432666 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: COMMIT
[0m00:20:23.435667 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.438666 [debug] [Thread-4 (]: Using duckdb connection "model.open_data_air_traffic.int_flights_with_weather"
[0m00:20:23.438666 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.int_flights_with_weather"} */

      drop view if exists "analytics"."main"."int_flights_with_weather__dbt_backup" cascade
    
[0m00:20:23.442181 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:20:23.444180 [debug] [Thread-4 (]: On model.open_data_air_traffic.int_flights_with_weather: Close
[0m00:20:23.445181 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1DC3170>]}
[0m00:20:23.445181 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.int_flights_with_weather ................. [[32mOK[0m in 0.05s]
[0m00:20:23.446179 [debug] [Thread-4 (]: Finished running node model.open_data_air_traffic.int_flights_with_weather
[0m00:20:23.448179 [debug] [Thread-1 (]: Began running node model.open_data_air_traffic.mart_flight_features
[0m00:20:23.448179 [debug] [Thread-3 (]: Began running node model.open_data_air_traffic.qa_daily_completeness
[0m00:20:23.449180 [debug] [Thread-2 (]: Began running node model.open_data_air_traffic.qa_join_coverage
[0m00:20:23.449180 [info ] [Thread-1 (]: 5 of 7 START sql table model main.mart_flight_features ......................... [RUN]
[0m00:20:23.450179 [info ] [Thread-3 (]: 6 of 7 START sql view model main.qa_daily_completeness ......................... [RUN]
[0m00:20:23.451464 [info ] [Thread-2 (]: 7 of 7 START sql view model main.qa_join_coverage .............................. [RUN]
[0m00:20:23.451464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_airports, now model.open_data_air_traffic.mart_flight_features)
[0m00:20:23.452464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_weather_hourly, now model.open_data_air_traffic.qa_daily_completeness)
[0m00:20:23.453462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.open_data_air_traffic.stg_opensky_flights, now model.open_data_air_traffic.qa_join_coverage)
[0m00:20:23.453462 [debug] [Thread-1 (]: Began compiling node model.open_data_air_traffic.mart_flight_features
[0m00:20:23.454464 [debug] [Thread-3 (]: Began compiling node model.open_data_air_traffic.qa_daily_completeness
[0m00:20:23.455461 [debug] [Thread-2 (]: Began compiling node model.open_data_air_traffic.qa_join_coverage
[0m00:20:23.458463 [debug] [Thread-1 (]: Writing injected SQL for node "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.462480 [debug] [Thread-3 (]: Writing injected SQL for node "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.465517 [debug] [Thread-2 (]: Writing injected SQL for node "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.467489 [debug] [Thread-1 (]: Began executing node model.open_data_air_traffic.mart_flight_features
[0m00:20:23.467489 [debug] [Thread-3 (]: Began executing node model.open_data_air_traffic.qa_daily_completeness
[0m00:20:23.541350 [debug] [Thread-1 (]: Writing runtime sql for node "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.545318 [debug] [Thread-3 (]: Writing runtime sql for node "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.545318 [debug] [Thread-2 (]: Began executing node model.open_data_air_traffic.qa_join_coverage
[0m00:20:23.549823 [debug] [Thread-2 (]: Writing runtime sql for node "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.550830 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.550830 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.551830 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: BEGIN
[0m00:20:23.552836 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.552836 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: BEGIN
[0m00:20:23.553836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:23.553836 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: BEGIN
[0m00:20:23.554837 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:20:23.555836 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:23.555836 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.557271 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.558279 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:20:23.558279 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.559276 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.559276 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.560277 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */

  
    
    

    create  table
      "analytics"."main"."mart_flight_features__dbt_tmp"
  
    as (
      with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
),
airports as (
    select *
    from "analytics"."main"."stg_airports"
),
holidays as (
    select
        cast(date as date) as holiday_date,
        upper(country_code) as country_code,
        is_holiday
    from "analytics"."main"."holidays_eu"
)

select
    f.icao24,
    f.callsign,
    f.flight_type,
    f.airport_icao,
    f.est_departure_airport,
    f.est_arrival_airport,
    f.first_seen_ts_utc,
    f.last_seen_ts_utc,
    f.event_hour_utc,
    date_diff('minute', f.first_seen_ts_utc, f.last_seen_ts_utc) as flight_duration_min,
    extract('hour' from f.event_hour_utc) as hour_of_day_utc,
    extract('dow' from f.event_hour_utc) as day_of_week_utc,
    extract('month' from f.event_hour_utc) as month_utc,
    extract('week' from f.event_hour_utc) as week_of_year_utc,
    extract('doy' from f.event_hour_utc) as day_of_year_utc,
    case when extract('dow' from f.event_hour_utc) in (0, 6) then true else false end as is_weekend_utc,
    f.temperature_2m,
    f.precipitation,
    f.wind_speed_10m,
    f.cloud_cover,
    a.country_code as airport_country_code,
    concat(f.est_departure_airport, '-', f.est_arrival_airport) as route_code,
    coalesce(h.is_holiday, false) as is_holiday
from flights f
left join airports a
    on a.icao = f.airport_icao
left join holidays h
    on h.country_code = a.country_code
   and h.holiday_date = cast(f.event_hour_utc as date)
    );
  
  
[0m00:20:23.561574 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */

  
  create view "analytics"."main"."qa_daily_completeness__dbt_tmp" as (
    with flights as (
    select
        airport_icao,
        date_trunc('day', event_hour_utc) as day_utc,
        count(*) as flights_count
    from "analytics"."main"."int_flights_with_weather"
    group by 1, 2
),
weather as (
    select
        airport_icao,
        date_trunc('day', time_utc) as day_utc,
        count(*) as weather_hours_count
    from "analytics"."main"."stg_weather_hourly"
    group by 1, 2
)

select
    coalesce(f.airport_icao, w.airport_icao) as airport_icao,
    coalesce(f.day_utc, w.day_utc) as day_utc,
    coalesce(f.flights_count, 0) as flights_count,
    coalesce(w.weather_hours_count, 0) as weather_hours_count,
    case
        when coalesce(w.weather_hours_count, 0) >= 24 then 0
        else 24 - coalesce(w.weather_hours_count, 0)
    end as missing_weather_hours
from flights f
full join weather w
    on f.airport_icao = w.airport_icao
   and f.day_utc = w.day_utc
  );

[0m00:20:23.561574 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */

  
  create view "analytics"."main"."qa_join_coverage__dbt_tmp" as (
    with flights as (
    select *
    from "analytics"."main"."int_flights_with_weather"
)

select
    date_trunc('day', event_hour_utc) as day_utc,
    count(*) as flights_total,
    count(*) filter (where temperature_2m is not null) as flights_with_weather,
    round(
        100.0 * count(*) filter (where temperature_2m is not null) / nullif(count(*), 0),
        2
    ) as pct_with_weather
from flights
group by 1
  );

[0m00:20:23.570186 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m00:20:23.573196 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.574212 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m00:20:23.574212 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */
alter view "analytics"."main"."qa_join_coverage" rename to "qa_join_coverage__dbt_backup"
[0m00:20:23.578227 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.579197 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */
alter view "analytics"."main"."qa_daily_completeness" rename to "qa_daily_completeness__dbt_backup"
[0m00:20:23.579197 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.583312 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.583312 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:20:23.584312 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */
alter view "analytics"."main"."qa_join_coverage__dbt_tmp" rename to "qa_join_coverage"
[0m00:20:23.587312 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.588179 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */
alter view "analytics"."main"."qa_daily_completeness__dbt_tmp" rename to "qa_daily_completeness"
[0m00:20:23.589184 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.591372 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: COMMIT
[0m00:20:23.591372 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:20:23.592372 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.594342 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: COMMIT
[0m00:20:23.594342 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: COMMIT
[0m00:20:23.595343 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.596341 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: COMMIT
[0m00:20:23.598342 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:20:23.600853 [debug] [Thread-2 (]: Using duckdb connection "model.open_data_air_traffic.qa_join_coverage"
[0m00:20:23.601854 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:20:23.601854 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_join_coverage"} */

      drop view if exists "analytics"."main"."qa_join_coverage__dbt_backup" cascade
    
[0m00:20:23.604859 [debug] [Thread-3 (]: Using duckdb connection "model.open_data_air_traffic.qa_daily_completeness"
[0m00:20:23.605859 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.qa_daily_completeness"} */

      drop view if exists "analytics"."main"."qa_daily_completeness__dbt_backup" cascade
    
[0m00:20:23.607858 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:20:23.610366 [debug] [Thread-2 (]: On model.open_data_air_traffic.qa_join_coverage: Close
[0m00:20:23.611372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B156CDA0>]}
[0m00:20:23.611372 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:20:23.612377 [info ] [Thread-2 (]: 7 of 7 OK created sql view model main.qa_join_coverage ......................... [[32mOK[0m in 0.16s]
[0m00:20:23.614378 [debug] [Thread-3 (]: On model.open_data_air_traffic.qa_daily_completeness: Close
[0m00:20:23.615379 [debug] [Thread-2 (]: Finished running node model.open_data_air_traffic.qa_join_coverage
[0m00:20:23.616378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1DC30B0>]}
[0m00:20:23.617019 [info ] [Thread-3 (]: 6 of 7 OK created sql view model main.qa_daily_completeness .................... [[32mOK[0m in 0.16s]
[0m00:20:23.618029 [debug] [Thread-3 (]: Finished running node model.open_data_air_traffic.qa_daily_completeness
[0m00:20:23.644093 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m00:20:23.647061 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.648060 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */
alter table "analytics"."main"."mart_flight_features__dbt_tmp" rename to "mart_flight_features"
[0m00:20:23.649060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:20:23.655121 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: COMMIT
[0m00:20:23.656120 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.657123 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: COMMIT
[0m00:20:23.661347 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:20:23.666865 [debug] [Thread-1 (]: Using duckdb connection "model.open_data_air_traffic.mart_flight_features"
[0m00:20:23.666865 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "open_data_air_traffic", "target_name": "dev", "node_id": "model.open_data_air_traffic.mart_flight_features"} */

      drop table if exists "analytics"."main"."mart_flight_features__dbt_backup" cascade
    
[0m00:20:23.667865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:20:23.669866 [debug] [Thread-1 (]: On model.open_data_air_traffic.mart_flight_features: Close
[0m00:20:23.670376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424eccaf-9fe9-4b63-a4fc-a49267b91f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B1EE4EC0>]}
[0m00:20:23.671379 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.mart_flight_features .................... [[32mOK[0m in 0.22s]
[0m00:20:23.672378 [debug] [Thread-1 (]: Finished running node model.open_data_air_traffic.mart_flight_features
[0m00:20:23.674378 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:23.674378 [debug] [MainThread]: On master: BEGIN
[0m00:20:23.674378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:23.675377 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:20:23.676377 [debug] [MainThread]: On master: COMMIT
[0m00:20:23.676377 [debug] [MainThread]: Using duckdb connection "master"
[0m00:20:23.677379 [debug] [MainThread]: On master: COMMIT
[0m00:20:23.677379 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:20:23.678382 [debug] [MainThread]: On master: Close
[0m00:20:23.678382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:23.678382 [debug] [MainThread]: Connection 'create_analytics_main' was properly closed.
[0m00:20:23.679886 [debug] [MainThread]: Connection 'list_analytics_main' was properly closed.
[0m00:20:23.679886 [debug] [MainThread]: Connection 'model.open_data_air_traffic.mart_flight_features' was properly closed.
[0m00:20:23.680892 [debug] [MainThread]: Connection 'model.open_data_air_traffic.qa_join_coverage' was properly closed.
[0m00:20:23.680892 [debug] [MainThread]: Connection 'model.open_data_air_traffic.qa_daily_completeness' was properly closed.
[0m00:20:23.681891 [debug] [MainThread]: Connection 'model.open_data_air_traffic.int_flights_with_weather' was properly closed.
[0m00:20:23.681891 [info ] [MainThread]: 
[0m00:20:23.682890 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m00:20:23.684894 [debug] [MainThread]: Command end result
[0m00:20:23.711158 [debug] [MainThread]: Wrote artifact WritableManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\manifest.json
[0m00:20:23.714138 [debug] [MainThread]: Wrote artifact SemanticManifest to H:\Bureau\Pro\Ecole\Open Data\dbt\target\semantic_manifest.json
[0m00:20:23.721645 [debug] [MainThread]: Wrote artifact RunExecutionResult to H:\Bureau\Pro\Ecole\Open Data\dbt\target\run_results.json
[0m00:20:23.721645 [info ] [MainThread]: 
[0m00:20:23.722831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:23.723838 [info ] [MainThread]: 
[0m00:20:23.723838 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m00:20:23.725866 [debug] [MainThread]: Command `dbt run` succeeded at 00:20:23.724836 after 1.90 seconds
[0m00:20:23.725866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AFEF4FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AF8F57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AF8F66C0>]}
[0m00:20:23.726840 [debug] [MainThread]: Flushing usage events
[0m00:20:24.164349 [debug] [MainThread]: An error was encountered while trying to flush usage events
